<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Quiz — Direito Administrativo (Sessão 09)</title>
<style>
  :root{
    --bg:#0f172a; --card:#111827; --ink:#e5e7eb; --mute:#94a3b8; --acc:#22d3ee; --good:#22c55e; --bad:#ef4444;
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue','Noto Sans',sans-serif}
  .wrap{max-width:980px;margin:40px auto;padding:0 16px}
  .card{background:linear-gradient(180deg,#0b1220 0,#0b1220ee 70%,#0b1220cc 100%),radial-gradient(1100px 500px at 110% -10%,#1f2937 0,#0b1220 60%);border:1px solid #1f2937;border-radius:18px;padding:20px 18px;box-shadow:0 10px 30px #0006}
  h1{font-size:1.6rem;margin:0 0 6px}
  .sub{color:var(--mute);margin:0 0 18px}
  select,button{font:inherit;color:var(--ink);background:#0b1220;border:1px solid #1f2937;border-radius:12px;padding:10px 12px}
  select:focus,button:focus{outline:2px solid var(--acc);outline-offset:2px}
  button.primary{background:#0b1220;border-color:#334155}
  button.primary:hover{border-color:#475569}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .pill{display:inline-flex;gap:10px;align-items:center;background:#0b1220;border:1px solid #1f2937;border-radius:999px;padding:8px 12px;font-size:.95rem;color:var(--mute)}
  .q{margin:14px 0 18px;padding:16px;border:1px solid #1f2937;border-radius:14px;background:#0b1220b3}
  .q h3{font-size:1rem;margin:0 0 10px}
  .opts{display:grid;gap:8px}
  .opt{display:flex;gap:10px;align-items:flex-start;padding:10px;border:1px solid #1f2937;border-radius:10px;background:#0b1220}
  .opt input{margin-top:3px;accent-color:var(--acc)}
  .disabled{pointer-events:none;opacity:.8}
  .badge{display:inline-block;padding:2px 8px;border-radius:999px;font-weight:600;font-size:.8rem}
  .ok{background:color-mix(in srgb, var(--good) 20%, transparent);border:1px solid var(--good);color:#bbf7d0}
  .ko{background:color-mix(in srgb, var(--bad) 15%, transparent);border:1px solid var(--bad);color:#fecaca}
  .explain{color:var(--mute);margin-top:8px;font-size:.94rem}
  .sticky{position:sticky;top:0;z-index:3;background:linear-gradient(#0f172a,#0f172aCC 80%,transparent);padding:10px 0 6px;margin:-10px 0 10px}
  .footer{display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-top:16px}
  .counts{display:flex;gap:8px;flex-wrap:wrap}
  .k{border:1px solid #1f2937;border-radius:10px;padding:6px 10px;color:var(--mute)}
  .score{font-weight:700}
  .muted{color:var(--mute)}
  .warning{border-left:4px solid #f59e0b;padding:10px 12px;border-radius:8px;background:#0b1220;margin:10px 0;color:#fde68a}
  @media (prefers-reduced-motion:no-preference){
    .q{transition:transform .15s ease, background .2s ease}
    .q:hover{transform:translateY(-1px)}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Quiz — Direito Administrativo: Sessão 09</h1>
    <p class="sub">Responde às 50 perguntas de Verdadeiro/Falso. No fim verás a correção e a nota (/20).</p>

    <div class="row" style="margin-bottom:12px">
      <button id="startBtn" class="primary">Começar / Reiniciar</button>
      <span class="pill">Progresso: <span id="prog">0/50</span></span>
      <span class="pill">Estado: <span id="state">Em resposta</span></span>
    </div>

    <div id="quizArea"></div>

    <div class="sticky">
      <div class="footer">
        <div class="counts">
          <span class="k">Certas: <strong id="cRight">0</strong></span>
          <span class="k">Erradas: <strong id="cWrong">0</strong></span>
          <span class="k">Em branco: <strong id="cBlank">50</strong></span>
          <span class="k score">Nota (/20): <strong id="score">–</strong></span>
        </div>
        <div class="row">
          <button id="submitBtn" class="primary">Entregar</button>
          <button id="exportBtn" title="Exportar resultados para .txt" disabled>Exportar .txt</button>
          <button id="clearBtn" title="Limpar respostas">Limpar</button>
        </div>
      </div>
    </div>

    <p class="muted" style="margin-top:8px">As perguntas baralham a cada início. Este quiz é apenas para a Sessão 09.</p>
  </div>
</div>

<script>
/* ---------- Utilidades ---------- */
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
const el = (q)=>document.querySelector(q);
const $quiz   = el('#quizArea');
const $prog   = el('#prog');
const $state  = el('#state');
const $score  = el('#score');
const $cRight = el('#cRight');
const $cWrong = el('#cWrong');
const $cBlank = el('#cBlank');
const $submit = el('#submitBtn');
const $start  = el('#startBtn');
const $export = el('#exportBtn');
const $clear  = el('#clearBtn');

let CURRENT = { items:[], answers:{}, locked:false, evaluated:false };

/* ---------- Banco de 50 perguntas V/F ---------- */
/* Verdadeiro = true, Falso = false */
const QUESTIONS = [
  // 1
  { stem:"O procedimento administrativo é a sucessão ordenada de atos e formalidades relativos à formação, manifestação e execução da vontade dos órgãos da Administração Pública.", correct:true },
  // 2
  { stem:"O processo administrativo é o conceito oposto de procedimento administrativo, significando a sucessão de decisões políticas.", correct:false },
  // 3
  { stem:"A atividade administrativa, em sentido material, visa a satisfação regular e contínua das necessidades coletivas de segurança, cultura e bem-estar.", correct:true },
  // 4
  { stem:"O poder discricionário permite à Administração decidir com total liberdade, sem estar condicionada por qualquer critério legal.", correct:false },
  // 5
  { stem:"O poder discricionário é sempre exercido dentro de limites definidos pela lei e pelos princípios fundamentais.", correct:true },
  // 6
  { stem:"No poder vinculado, a Administração tem apenas uma solução possível prevista na lei.", correct:true },
  // 7
  { stem:"A remoção de veículos com alarme a tocar mais de 20 minutos, prevista no Regulamento Geral do Ruído, é um exemplo de poder vinculado.", correct:false },
  // 8
  { stem:"A apreensão imediata de determinados veículos prevista no artigo 112.º do Código da Estrada é um exemplo de poder vinculado da Administração.", correct:true },
  // 9
  { stem:"Segundo o artigo 2.º, n.º 1 do CPA, o código aplica-se apenas às pessoas coletivas públicas, excluindo entidades privadas com poderes públicos.", correct:false },
  // 10
  { stem:"O artigo 2.º, n.º 1 do CPA abrange também entidades privadas que disponham de poderes públicos administrativos.", correct:true },
  // 11
  { stem:"O regime da Parte II do CPA (artigos 20.º a 52.º) aplica-se exclusivamente ao funcionamento dos órgãos da Administração Pública.", correct:true },
  // 12
  { stem:"Os princípios gerais da atividade administrativa previstos nos artigos 3.º a 19.º do CPA integram o âmbito material definido no artigo 2.º, n.º 3.", correct:true },
  // 13
  { stem:"O direito à informação, a participação dos cidadãos, as notificações e a fundamentação são formas de concretização constitucional referidas no artigo 2.º, n.º 3 do CPA.", correct:true },
  // 14
  { stem:"Nos procedimentos disciplinares ou de contraordenação nunca são aplicáveis as garantias previstas no CPA.", correct:false },
  // 15
  { stem:"Nos procedimentos especiais, como disciplinares ou de urbanismo, as garantias do CPA aplicam-se de forma subsidiária quando a lei especial é omissa.", correct:true },
  // 16
  { stem:"O artigo 266.º, n.º 1 da CRP consagra que a Administração tem um limite positivo, que é a prossecução do interesse público.", correct:true },
  // 17
  { stem:"O limite negativo da atuação administrativa consiste no respeito pelos direitos e interesses legítimos dos cidadãos.", correct:true },
  // 18
  { stem:"Mesmo quando utiliza poderes discricionários, a Administração pode perseguir interesses particulares desde que existam razões de oportunidade.", correct:false },
  // 19
  { stem:"A vinculação da Administração aos direitos e interesses legalmente protegidos dos cidadãos resulta, entre outros, do artigo 18.º, n.º 1 da CRP.", correct:true },
  // 20
  { stem:"A violação dos direitos legalmente protegidos dos cidadãos nunca gera responsabilidade da Administração.", correct:false },
  // 21
  { stem:"A Administração está subordinada à Constituição e os atos administrativos que a violem diretamente são inválidos.", correct:true },
  // 22
  { stem:"O princípio da legalidade significa que a Administração está subordinada apenas à lei ordinária, não ao direito internacional.", correct:false },
  // 23
  { stem:"Segundo o princípio da igualdade, a Administração deve tratar de forma igual situações objetivamente iguais e pode discriminar arbitrariamente situações diferentes.", correct:false },
  // 24
  { stem:"O princípio da igualdade funciona como limite ao exercício do poder discricionário da Administração.", correct:true },
  // 25
  { stem:"O princípio da proporcionalidade obriga a Administração a escolher, entre as medidas adequadas, a que implica menores sacrifícios para os administrados.", correct:true },
  // 26
  { stem:"O princípio da justiça, no CPA, está ligado à conjugação de outros princípios e à procura de uma decisão racional, adequada e proporcional.", correct:true },
  // 27
  { stem:"O princípio da imparcialidade exige que as decisões sejam tomadas com base em critérios objetivos de interesse público, sem influência de interesses pessoais.", correct:true },
  // 28
  { stem:"A imparcialidade não se relaciona com o regime de impedimentos dos titulares de órgãos e agentes administrativos.", correct:false },
  // 29
  { stem:"O princípio da boa-fé assenta numa relação de confiança entre Administração e particulares e na fiabilidade da atividade administrativa.", correct:true },
  // 30
  { stem:"A violação dos princípios fundamentais de direito administrativo nunca afeta a validade dos atos administrativos.", correct:false },
  // 31
  { stem:"De acordo com o CPA, a violação de princípios como legalidade, igualdade ou proporcionalidade pode conduzir à nulidade ou à anulabilidade do ato administrativo.", correct:true },
  // 32
  { stem:"Regra geral, os vícios dos atos administrativos conduzem à nulidade, reservando-se a anulabilidade para situações excecionais.", correct:false },
  // 33
  { stem:"A nulidade do ato administrativo produz efeitos retroativos, como se o ato nunca tivesse existido no ordenamento jurídico.", correct:true },
  // 34
  { stem:"Na anulabilidade, os efeitos já produzidos pelo ato são preservados, sendo o ato apenas afastado para o futuro.", correct:true },
  // 35
  { stem:"O artigo 3.º do CPA consagra o princípio da legalidade, segundo o qual órgãos e agentes da Administração devem atuar com fundamento na lei.", correct:true },
  // 36
  { stem:"O artigo 4.º do CPA estabelece o princípio da prossecução do interesse público.", correct:true },
  // 37
  { stem:"A boa administração, prevista no artigo 5.º do CPA, está associada à desburocratização, à descentralização e à desconcentração administrativas.", correct:true },
  // 38
  { stem:"O princípio da igualdade encontra-se previsto no artigo 6.º do CPA.", correct:true },
  // 39
  { stem:"O princípio da participação dos particulares na formação das decisões está ligado ao artigo 12.º do CPA.", correct:true },
  // 40
  { stem:"O princípio da administração eletrónica afasta totalmente a possibilidade de atendimento presencial.", correct:false },
  // 41
  { stem:"O princípio da gratuitidade, no artigo 15.º do CPA, significa que todos os procedimentos administrativos são sempre gratuitos e nunca há lugar a taxas.", correct:false },
  // 42
  { stem:"A responsabilidade extracontratual do Estado, referida no artigo 16.º do CPA, está regulada na Lei n.º 67/2007, de 31 de dezembro.", correct:true },
  // 43
  { stem:"A administração aberta, no artigo 17.º do CPA, inclui o direito de acesso à informação administrativa e o escrutínio da atividade administrativa.", correct:true },
  // 44
  { stem:"A proteção dos dados pessoais, prevista no artigo 18.º do CPA, visa evitar o acesso, uso, divulgação ou destruição não autorizados de dados.", correct:true },
  // 45
  { stem:"O princípio da cooperação leal com a União Europeia, no artigo 19.º do CPA, impõe colaboração entre a Administração portuguesa e as instituições da União Europeia.", correct:true },
  // 46
  { stem:"O princípio da adequação procedimental (artigo 56.º) significa que o procedimento tem uma forma totalmente rígida, sem qualquer possibilidade de adaptação ao caso.", correct:false },
  // 47
  { stem:"A proibição do excesso de formalismo é um critério a ter em conta na adequação procedimental.", correct:true },
  // 48
  { stem:"O princípio do inquisitório atribui um papel ativo aos órgãos administrativos na instrução do procedimento e na preparação da decisão.", correct:true },
  // 49
  { stem:"O princípio da celeridade impõe à Administração um dever de atuar com rapidez, evitando atrasos desnecessários.", correct:true },
  // 50
  { stem:"O princípio da cooperação e boa-fé procedimental impede que os interessados usem expedientes dilatórios ou promovam diligências inúteis para atrasar a decisão.", correct:true }
];

const TOTAL = QUESTIONS.length;

/* ---------- Construção / execução ---------- */
function build(){
  CURRENT.items = shuffle(QUESTIONS);
  CURRENT.answers = {};
  CURRENT.locked = false;
  CURRENT.evaluated = false;
  render();
  updateCounts();
}

function render(){
  $quiz.innerHTML = '';
  CURRENT.items.forEach((q, idx)=>{
    const wrap = document.createElement('div');
    wrap.className = 'q';
    wrap.dataset.qid = 'Q'+(idx+1);
    const h = document.createElement('h3');
    h.innerHTML = `<span class="muted">Q${idx+1}.</span> ${q.stem}`;
    const opts = document.createElement('div');
    opts.className = 'opts';
    ['Verdadeiro','Falso'].forEach((optText, optIdx)=>{
      const id = `Q${idx+1}-o${optIdx}`;
      const line = document.createElement('label');
      line.className = 'opt';
      line.innerHTML = `
        <input type="radio" name="Q${idx+1}" id="${id}" value="${optIdx}">
        <div>${optText}</div>
      `;
      opts.appendChild(line);
    });
    wrap.appendChild(h);
    wrap.appendChild(opts);
    $quiz.appendChild(wrap);
  });

  $state.textContent = 'Em resposta';
  $score.textContent = '–';
  $cRight.textContent = '0';
  $cWrong.textContent = '0';
  $cBlank.textContent = String(TOTAL);
  $export.disabled = true;
}

function onSelect(e){
  if(!e.target || e.target.type!=='radio') return;
  if(CURRENT.locked) return;
  const name = e.target.name; // Qn
  const val = Number(e.target.value);
  CURRENT.answers[name] = val;
  updateCounts();
}

function updateCounts(){
  const answered = Object.keys(CURRENT.answers).length;
  $prog.textContent = `${answered}/${TOTAL}`;
  $cBlank.textContent = String(TOTAL-answered);
}

function evaluate(){
  if(CURRENT.evaluated) return;
  CURRENT.locked = true;
  CURRENT.evaluated = true;
  $state.textContent = 'Corrigido';
  let right=0, wrong=0;

  const qs = $quiz.querySelectorAll('.q');
  qs.forEach((qEl, idx)=>{
    const qid = qEl.dataset.qid;
    const item = CURRENT.items[idx];
    const chosen = CURRENT.answers[qid];
    const correctIdx = item.correct ? 0 : 1;

    const labels = qEl.querySelectorAll('.opt');
    labels.forEach((lab, i)=>{
      const input = lab.querySelector('input');
      input.disabled = true;
      if(i===correctIdx){
        lab.classList.add('ok');
        lab.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--good');
      }
      if(chosen!==undefined && i===chosen && chosen!==correctIdx){
        lab.classList.add('ko');
